[ema@testlab:atelier-09] $ vagrant up
Bringing machine 'target01' up with 'virtualbox' provider...
Bringing machine 'target02' up with 'virtualbox' provider...
Bringing machine 'target03' up with 'virtualbox' provider...
Bringing machine 'control' up with 'virtualbox' provider...
==> target01: Importing base box 'generic/debian12'...
==> target01: Matching MAC address for NAT networking...
==> target01: Checking if box 'generic/debian12' version '4.3.12' is up to date...
==> target01: Setting the name of the VM: atelier-09_target01_1742891044436_63565
==> target01: Clearing any previously set network interfaces...
==> target01: Preparing network interfaces based on configuration...
    target01: Adapter 1: nat
    target01: Adapter 2: hostonly
==> target01: Forwarding ports...
    target01: 22 (guest) => 2222 (host) (adapter 1)
==> target01: Running 'pre-boot' VM customizations...
==> target01: Booting VM...
==> target01: Waiting for machine to boot. This may take a few minutes...
    target01: SSH address: 127.0.0.1:2222
    target01: SSH username: vagrant
    target01: SSH auth method: private key
    target01: 
    target01: Vagrant insecure key detected. Vagrant will automatically replace
    target01: this with a newly generated keypair for better security.
    target01: 
    target01: Inserting generated public key within guest...
    target01: Removing insecure key from the guest if it's present...
    target01: Key inserted! Disconnecting and reconnecting using new SSH key...
==> target01: Machine booted and ready!
==> target01: Setting hostname...
==> target01: Configuring and enabling network interfaces...
==> target01: Mounting shared folders...
    target01: /home/ema/formation-ansible/atelier-09 => /vagrant
==> target02: Importing base box 'generic/debian12'...
==> target02: Matching MAC address for NAT networking...
==> target02: Checking if box 'generic/debian12' version '4.3.12' is up to date...
==> target02: Setting the name of the VM: atelier-09_target02_1742891092722_56820
==> target02: Fixed port collision for 22 => 2222. Now on port 2200.
==> target02: Clearing any previously set network interfaces...
==> target02: Preparing network interfaces based on configuration...
    target02: Adapter 1: nat
    target02: Adapter 2: hostonly
==> target02: Forwarding ports...
    target02: 22 (guest) => 2200 (host) (adapter 1)
==> target02: Running 'pre-boot' VM customizations...
==> target02: Booting VM...
==> target02: Waiting for machine to boot. This may take a few minutes...
    target02: SSH address: 127.0.0.1:2200
    target02: SSH username: vagrant
    target02: SSH auth method: private key
    target02: 
    target02: Vagrant insecure key detected. Vagrant will automatically replace
    target02: this with a newly generated keypair for better security.
    target02: 
    target02: Inserting generated public key within guest...
    target02: Removing insecure key from the guest if it's present...
    target02: Key inserted! Disconnecting and reconnecting using new SSH key...
==> target02: Machine booted and ready!
==> target02: Setting hostname...
==> target02: Configuring and enabling network interfaces...
==> target02: Mounting shared folders...
    target02: /home/ema/formation-ansible/atelier-09 => /vagrant
==> target03: Importing base box 'generic/debian12'...
==> target03: Matching MAC address for NAT networking...
==> target03: Checking if box 'generic/debian12' version '4.3.12' is up to date...
==> target03: Setting the name of the VM: atelier-09_target03_1742891148822_23478
==> target03: Fixed port collision for 22 => 2222. Now on port 2201.
==> target03: Clearing any previously set network interfaces...
==> target03: Preparing network interfaces based on configuration...
    target03: Adapter 1: nat
    target03: Adapter 2: hostonly
==> target03: Forwarding ports...
    target03: 22 (guest) => 2201 (host) (adapter 1)
==> target03: Running 'pre-boot' VM customizations...
==> target03: Booting VM...
==> target03: Waiting for machine to boot. This may take a few minutes...
    target03: SSH address: 127.0.0.1:2201
    target03: SSH username: vagrant
    target03: SSH auth method: private key
    target03: 
    target03: Vagrant insecure key detected. Vagrant will automatically replace
    target03: this with a newly generated keypair for better security.
    target03: 
    target03: Inserting generated public key within guest...
    target03: Removing insecure key from the guest if it's present...
    target03: Key inserted! Disconnecting and reconnecting using new SSH key...
==> target03: Machine booted and ready!
==> target03: Setting hostname...
==> target03: Configuring and enabling network interfaces...
==> target03: Mounting shared folders...
    target03: /home/ema/formation-ansible/atelier-09 => /vagrant
==> control: Importing base box 'generic/debian12'...
==> control: Matching MAC address for NAT networking...
==> control: Checking if box 'generic/debian12' version '4.3.12' is up to date...
==> control: Setting the name of the VM: atelier-09_control_1742891198958_83912
==> control: Fixed port collision for 22 => 2222. Now on port 2202.
==> control: Clearing any previously set network interfaces...
==> control: Preparing network interfaces based on configuration...
    control: Adapter 1: nat
    control: Adapter 2: hostonly
==> control: Forwarding ports...
    control: 22 (guest) => 2202 (host) (adapter 1)
==> control: Running 'pre-boot' VM customizations...
==> control: Booting VM...
==> control: Waiting for machine to boot. This may take a few minutes...
    control: SSH address: 127.0.0.1:2202
    control: SSH username: vagrant
    control: SSH auth method: private key
    control: 
    control: Vagrant insecure key detected. Vagrant will automatically replace
    control: this with a newly generated keypair for better security.
    control: 
    control: Inserting generated public key within guest...
    control: Removing insecure key from the guest if it's present...
    control: Key inserted! Disconnecting and reconnecting using new SSH key...
==> control: Machine booted and ready!
==> control: Setting hostname...
==> control: Configuring and enabling network interfaces...
==> control: Mounting shared folders...
    control: /home/ema/formation-ansible/atelier-09 => /vagrant
==> control: Running provisioner: shell...
    control: Running: /tmp/vagrant-shell20250325-39680-vrhxec.sh
    control: '/vagrant/hosts' -> '/etc/hosts'
    control: Get:1 http://deb.debian.org/debian bookworm InRelease [151 kB]
    control: Get:2 http://security.debian.org/debian-security bookworm-security InRelease [48.0 kB]
    control: Get:3 http://deb.debian.org/debian bookworm-updates InRelease [55.4 kB]
    control: Get:4 http://security.debian.org/debian-security bookworm-security/main Sources [147 kB]
    control: Get:5 http://deb.debian.org/debian bookworm/non-free-firmware Sources [6,440 B]
    control: Get:6 http://security.debian.org/debian-security bookworm-security/main amd64 Packages [250 kB]
    control: Get:7 http://deb.debian.org/debian bookworm/main Sources [9,495 kB]
    control: Get:8 http://security.debian.org/debian-security bookworm-security/main Translation-en [150 kB]
    control: Get:9 http://deb.debian.org/debian bookworm/main amd64 Packages [8,792 kB]
    control: Get:10 http://deb.debian.org/debian bookworm/main Translation-en [6,109 kB]
    control: Get:11 http://deb.debian.org/debian bookworm/non-free-firmware amd64 Packages [6,240 B]
    control: Get:12 http://deb.debian.org/debian bookworm/non-free-firmware Translation-en [20.9 kB]
    control: Get:13 http://deb.debian.org/debian bookworm-updates/main Sources.diff/Index [15.1 kB]
    control: Ign:13 http://deb.debian.org/debian bookworm-updates/main Sources.diff/Index
    control: Get:14 http://deb.debian.org/debian bookworm-updates/main amd64 Packages.diff/Index [15.1 kB]
    control: Ign:14 http://deb.debian.org/debian bookworm-updates/main amd64 Packages.diff/Index
    control: Get:15 http://deb.debian.org/debian bookworm-updates/main Translation-en.diff/Index [15.1 kB]
    control: Ign:15 http://deb.debian.org/debian bookworm-updates/main Translation-en.diff/Index
    control: Get:16 http://deb.debian.org/debian bookworm-updates/non-free-firmware Sources [2,076 B]
    control: Get:17 http://deb.debian.org/debian bookworm-updates/non-free-firmware amd64 Packages [616 B]
    control: Get:18 http://deb.debian.org/debian bookworm-updates/non-free-firmware Translation-en [384 B]
    control: Get:19 http://deb.debian.org/debian bookworm-updates/main Sources [16.2 kB]
    control: Get:20 http://deb.debian.org/debian bookworm-updates/main amd64 Packages [13.5 kB]
    control: Get:21 http://deb.debian.org/debian bookworm-updates/main Translation-en [16.0 kB]
    control: Fetched 25.3 MB in 3s (9,807 kB/s)
    control: Reading package lists...
    control: Reading package lists...
    control: Building dependency tree...
    control: Reading state information...
    control: The following additional packages will be installed:
    control:   ansible-core ieee-data libyaml-0-2 python-babel-localedata python3-anyio
    control:   python3-argcomplete python3-babel python3-cffi-backend python3-click
    control:   python3-colorama python3-cryptography python3-distutils python3-dnspython
    control:   python3-h11 python3-h2 python3-hpack python3-httpcore python3-httpx
    control:   python3-hyperframe python3-jinja2 python3-jmespath python3-kerberos
    control:   python3-lib2to3 python3-libcloud python3-lockfile python3-markdown-it
    control:   python3-markupsafe python3-mdurl python3-netaddr python3-ntlm-auth
    control:   python3-packaging python3-passlib python3-pathspec python3-pygments
    control:   python3-requests-kerberos python3-requests-ntlm python3-requests-toolbelt
    control:   python3-resolvelib python3-rfc3986 python3-rich python3-selinux
    control:   python3-simplejson python3-sniffio python3-tz python3-winrm
    control:   python3-xmltodict python3-yaml
    control: Suggested packages:
    control:   cowsay python-cryptography-doc python3-cryptography-vectors python3-trio
    control:   python3-aioquic python-jinja2-doc python-lockfile-doc ipython3
    control:   python-netaddr-docs python-pygments-doc ttf-bitstream-vera
    control: The following NEW packages will be installed:
    control:   ansible ansible-core direnv ieee-data libyaml-0-2 python-babel-localedata
    control:   python3-anyio python3-argcomplete python3-babel python3-cffi-backend
    control:   python3-click python3-colorama python3-cryptography python3-distutils
    control:   python3-dnspython python3-h11 python3-h2 python3-hpack python3-httpcore
    control:   python3-httpx python3-hyperframe python3-jinja2 python3-jmespath
    control:   python3-kerberos python3-lib2to3 python3-libcloud python3-lockfile
    control:   python3-markdown-it python3-markupsafe python3-mdurl python3-netaddr
    control:   python3-ntlm-auth python3-packaging python3-passlib python3-pathspec
    control:   python3-pygments python3-requests-kerberos python3-requests-ntlm
    control:   python3-requests-toolbelt python3-resolvelib python3-rfc3986 python3-rich
    control:   python3-selinux python3-simplejson python3-sniffio python3-tz python3-winrm
    control:   python3-xmltodict python3-yaml sshpass yamllint
    control: 0 upgraded, 51 newly installed, 0 to remove and 95 not upgraded.
    control: Need to get 33.2 MB of archives.
    control: After this operation, 353 MB of additional disk space will be used.
    control: Get:1 http://deb.debian.org/debian bookworm/main amd64 python3-cffi-backend amd64 1.15.1-5+b1 [84.6 kB]
    control: Get:2 http://deb.debian.org/debian bookworm/main amd64 python3-cryptography amd64 38.0.4-3+deb12u1 [665 kB]
    control: Get:3 http://deb.debian.org/debian bookworm/main amd64 python3-markupsafe amd64 2.1.2-1+b1 [13.2 kB]
    control: Get:4 http://deb.debian.org/debian bookworm/main amd64 python3-jinja2 all 3.1.2-1+deb12u2 [120 kB]
    control: Get:5 http://deb.debian.org/debian bookworm/main amd64 python3-packaging all 23.0-1 [32.5 kB]
    control: Get:6 http://deb.debian.org/debian bookworm/main amd64 python3-resolvelib all 0.9.0-2 [27.3 kB]
    control: Get:7 http://deb.debian.org/debian bookworm/main amd64 libyaml-0-2 amd64 0.2.5-1 [53.6 kB]
    control: Get:8 http://deb.debian.org/debian bookworm/main amd64 python3-yaml amd64 6.0-3+b2 [119 kB]
    control: Get:9 http://deb.debian.org/debian bookworm/main amd64 python3-lib2to3 all 3.11.2-3 [76.3 kB]
    control: Get:10 http://deb.debian.org/debian bookworm/main amd64 python3-distutils all 3.11.2-3 [131 kB]
    control: Get:11 http://deb.debian.org/debian bookworm/main amd64 python3-dnspython all 2.3.0-1 [152 kB]
    control: Get:12 http://deb.debian.org/debian bookworm/main amd64 ieee-data all 20220827.1 [2,029 kB]
    control: Get:13 http://deb.debian.org/debian bookworm/main amd64 python3-netaddr all 0.8.0-2 [295 kB]
    control: Get:14 http://deb.debian.org/debian bookworm/main amd64 ansible-core all 2.14.18-0+deb12u2 [1,291 kB]
    control: Get:15 http://deb.debian.org/debian bookworm/main amd64 ansible all 7.7.0+dfsg-3+deb12u1 [16.9 MB]
    control: Get:16 http://deb.debian.org/debian bookworm/main amd64 direnv amd64 2.32.1-2+b4 [2,233 kB]
    control: Get:17 http://deb.debian.org/debian bookworm/main amd64 python-babel-localedata all 2.10.3-1 [5,615 kB]
    control: Get:18 http://deb.debian.org/debian bookworm/main amd64 python3-sniffio all 1.2.0-1 [6,372 B]
    control: Get:19 http://deb.debian.org/debian bookworm/main amd64 python3-anyio all 3.6.2-1 [54.0 kB]
    control: Get:20 http://deb.debian.org/debian bookworm/main amd64 python3-argcomplete all 2.0.0-1 [34.7 kB]
    control: Get:21 http://deb.debian.org/debian bookworm/main amd64 python3-tz all 2022.7.1-4 [30.1 kB]
    control: Get:22 http://deb.debian.org/debian bookworm/main amd64 python3-babel all 2.10.3-1 [103 kB]
    control: Get:23 http://deb.debian.org/debian bookworm/main amd64 python3-colorama all 0.4.6-2 [36.8 kB]
    control: Get:24 http://deb.debian.org/debian bookworm/main amd64 python3-click all 8.1.3-2 [92.2 kB]
    control: Get:25 http://deb.debian.org/debian bookworm/main amd64 python3-h11 all 0.14.0-1 [50.1 kB]
    control: Get:26 http://deb.debian.org/debian bookworm/main amd64 python3-hpack all 4.0.0-2 [25.0 kB]
    control: Get:27 http://deb.debian.org/debian bookworm/main amd64 python3-hyperframe all 6.0.0-1 [14.5 kB]
    control: Get:28 http://deb.debian.org/debian bookworm/main amd64 python3-h2 all 4.1.0-4 [80.8 kB]
    control: Get:29 http://deb.debian.org/debian bookworm/main amd64 python3-httpcore all 0.16.3-1 [38.4 kB]
    control: Get:30 http://deb.debian.org/debian bookworm/main amd64 python3-pygments all 2.14.0+dfsg-1 [783 kB]
    control: Get:31 http://deb.debian.org/debian bookworm/main amd64 python3-mdurl all 0.1.2-1 [9,444 B]
    control: Get:32 http://deb.debian.org/debian bookworm/main amd64 python3-markdown-it all 2.1.0-5 [58.8 kB]
    control: Get:33 http://deb.debian.org/debian bookworm/main amd64 python3-rich all 13.3.1-1 [202 kB]
    control: Get:34 http://deb.debian.org/debian bookworm/main amd64 python3-rfc3986 all 1.5.0-2 [22.2 kB]
    control: Get:35 http://deb.debian.org/debian bookworm/main amd64 python3-httpx all 0.23.3-1 [72.3 kB]
    control: Get:36 http://deb.debian.org/debian bookworm/main amd64 python3-jmespath all 1.0.1-1 [21.1 kB]
    control: Get:37 http://deb.debian.org/debian bookworm/main amd64 python3-kerberos amd64 1.1.14-3.1+b7 [21.5 kB]
    control: Get:38 http://deb.debian.org/debian bookworm/main amd64 python3-lockfile all 1:0.12.2-2.2 [17.3 kB]
    control: Get:39 http://deb.debian.org/debian bookworm/main amd64 python3-simplejson amd64 3.18.3-1 [59.8 kB]
    control: Get:40 http://deb.debian.org/debian bookworm/main amd64 python3-libcloud all 3.4.1-5 [808 kB]
    control: Get:41 http://deb.debian.org/debian bookworm/main amd64 python3-ntlm-auth all 1.4.0-2 [21.9 kB]
    control: Get:42 http://deb.debian.org/debian bookworm/main amd64 python3-passlib all 1.7.4-3 [367 kB]
    control: Get:43 http://deb.debian.org/debian bookworm/main amd64 python3-pathspec all 0.11.0-1 [26.3 kB]
    control: Get:44 http://deb.debian.org/debian bookworm/main amd64 python3-requests-kerberos all 0.12.0-2 [13.0 kB]
    control: Get:45 http://deb.debian.org/debian bookworm/main amd64 python3-requests-ntlm all 1.1.0-3 [6,268 B]
    control: Get:46 http://deb.debian.org/debian bookworm/main amd64 python3-requests-toolbelt all 0.10.1-1 [41.3 kB]
    control: Get:47 http://deb.debian.org/debian bookworm/main amd64 python3-selinux amd64 3.4-1+b6 [152 kB]
    control: Get:48 http://deb.debian.org/debian bookworm/main amd64 python3-xmltodict all 0.13.0-1 [16.7 kB]
    control: Get:49 http://deb.debian.org/debian bookworm/main amd64 python3-winrm all 0.3.0-4+deb12u1 [22.1 kB]
    control: Get:50 http://deb.debian.org/debian bookworm/main amd64 sshpass amd64 1.09-1+b1 [13.0 kB]
    control: Get:51 http://deb.debian.org/debian bookworm/main amd64 yamllint all 1.29.0-1 [42.0 kB]
    control: dpkg-preconfigure: unable to re-open stdin: No such file or directory
    control: Fetched 33.2 MB in 4s (9,129 kB/s)
    control: Selecting previously unselected package python3-cffi-backend:amd64.
(Reading database ... 60505 files and directories currently installed.)
    control: Preparing to unpack .../00-python3-cffi-backend_1.15.1-5+b1_amd64.deb ...
    control: Unpacking python3-cffi-backend:amd64 (1.15.1-5+b1) ...
    control: Selecting previously unselected package python3-cryptography.
    control: Preparing to unpack .../01-python3-cryptography_38.0.4-3+deb12u1_amd64.deb ...
    control: Unpacking python3-cryptography (38.0.4-3+deb12u1) ...
    control: Selecting previously unselected package python3-markupsafe.
    control: Preparing to unpack .../02-python3-markupsafe_2.1.2-1+b1_amd64.deb ...
    control: Unpacking python3-markupsafe (2.1.2-1+b1) ...
    control: Selecting previously unselected package python3-jinja2.
    control: Preparing to unpack .../03-python3-jinja2_3.1.2-1+deb12u2_all.deb ...
    control: Unpacking python3-jinja2 (3.1.2-1+deb12u2) ...
    control: Selecting previously unselected package python3-packaging.
    control: Preparing to unpack .../04-python3-packaging_23.0-1_all.deb ...
    control: Unpacking python3-packaging (23.0-1) ...
    control: Selecting previously unselected package python3-resolvelib.
    control: Preparing to unpack .../05-python3-resolvelib_0.9.0-2_all.deb ...
    control: Unpacking python3-resolvelib (0.9.0-2) ...
    control: Selecting previously unselected package libyaml-0-2:amd64.
    control: Preparing to unpack .../06-libyaml-0-2_0.2.5-1_amd64.deb ...
    control: Unpacking libyaml-0-2:amd64 (0.2.5-1) ...
    control: Selecting previously unselected package python3-yaml.
    control: Preparing to unpack .../07-python3-yaml_6.0-3+b2_amd64.deb ...
    control: Unpacking python3-yaml (6.0-3+b2) ...
    control: Selecting previously unselected package python3-lib2to3.
    control: Preparing to unpack .../08-python3-lib2to3_3.11.2-3_all.deb ...
    control: Unpacking python3-lib2to3 (3.11.2-3) ...
    control: Selecting previously unselected package python3-distutils.
    control: Preparing to unpack .../09-python3-distutils_3.11.2-3_all.deb ...
    control: Unpacking python3-distutils (3.11.2-3) ...
    control: Selecting previously unselected package python3-dnspython.
    control: Preparing to unpack .../10-python3-dnspython_2.3.0-1_all.deb ...
    control: Unpacking python3-dnspython (2.3.0-1) ...
    control: Selecting previously unselected package ieee-data.
    control: Preparing to unpack .../11-ieee-data_20220827.1_all.deb ...
    control: Unpacking ieee-data (20220827.1) ...
    control: Selecting previously unselected package python3-netaddr.
    control: Preparing to unpack .../12-python3-netaddr_0.8.0-2_all.deb ...
    control: Unpacking python3-netaddr (0.8.0-2) ...
    control: Selecting previously unselected package ansible-core.
    control: Preparing to unpack .../13-ansible-core_2.14.18-0+deb12u2_all.deb ...
    control: Unpacking ansible-core (2.14.18-0+deb12u2) ...
    control: Selecting previously unselected package ansible.
    control: Preparing to unpack .../14-ansible_7.7.0+dfsg-3+deb12u1_all.deb ...
    control: Unpacking ansible (7.7.0+dfsg-3+deb12u1) ...
    control: Selecting previously unselected package direnv.
    control: Preparing to unpack .../15-direnv_2.32.1-2+b4_amd64.deb ...
    control: Unpacking direnv (2.32.1-2+b4) ...
    control: Selecting previously unselected package python-babel-localedata.
    control: Preparing to unpack .../16-python-babel-localedata_2.10.3-1_all.deb ...
    control: Unpacking python-babel-localedata (2.10.3-1) ...
    control: Selecting previously unselected package python3-sniffio.
    control: Preparing to unpack .../17-python3-sniffio_1.2.0-1_all.deb ...
    control: Unpacking python3-sniffio (1.2.0-1) ...
    control: Selecting previously unselected package python3-anyio.
    control: Preparing to unpack .../18-python3-anyio_3.6.2-1_all.deb ...
    control: Unpacking python3-anyio (3.6.2-1) ...
    control: Selecting previously unselected package python3-argcomplete.
    control: Preparing to unpack .../19-python3-argcomplete_2.0.0-1_all.deb ...
    control: Unpacking python3-argcomplete (2.0.0-1) ...
    control: Selecting previously unselected package python3-tz.
    control: Preparing to unpack .../20-python3-tz_2022.7.1-4_all.deb ...
    control: Unpacking python3-tz (2022.7.1-4) ...
    control: Selecting previously unselected package python3-babel.
    control: Preparing to unpack .../21-python3-babel_2.10.3-1_all.deb ...
    control: Unpacking python3-babel (2.10.3-1) ...
    control: Selecting previously unselected package python3-colorama.
    control: Preparing to unpack .../22-python3-colorama_0.4.6-2_all.deb ...
    control: Unpacking python3-colorama (0.4.6-2) ...
    control: Selecting previously unselected package python3-click.
    control: Preparing to unpack .../23-python3-click_8.1.3-2_all.deb ...
    control: Unpacking python3-click (8.1.3-2) ...
    control: Selecting previously unselected package python3-h11.
    control: Preparing to unpack .../24-python3-h11_0.14.0-1_all.deb ...
    control: Unpacking python3-h11 (0.14.0-1) ...
    control: Selecting previously unselected package python3-hpack.
    control: Preparing to unpack .../25-python3-hpack_4.0.0-2_all.deb ...
    control: Unpacking python3-hpack (4.0.0-2) ...
    control: Selecting previously unselected package python3-hyperframe.
    control: Preparing to unpack .../26-python3-hyperframe_6.0.0-1_all.deb ...
    control: Unpacking python3-hyperframe (6.0.0-1) ...
    control: Selecting previously unselected package python3-h2.
    control: Preparing to unpack .../27-python3-h2_4.1.0-4_all.deb ...
    control: Unpacking python3-h2 (4.1.0-4) ...
    control: Selecting previously unselected package python3-httpcore.
    control: Preparing to unpack .../28-python3-httpcore_0.16.3-1_all.deb ...
    control: Unpacking python3-httpcore (0.16.3-1) ...
    control: Selecting previously unselected package python3-pygments.
    control: Preparing to unpack .../29-python3-pygments_2.14.0+dfsg-1_all.deb ...
    control: Unpacking python3-pygments (2.14.0+dfsg-1) ...
    control: Selecting previously unselected package python3-mdurl.
    control: Preparing to unpack .../30-python3-mdurl_0.1.2-1_all.deb ...
    control: Unpacking python3-mdurl (0.1.2-1) ...
    control: Selecting previously unselected package python3-markdown-it.
    control: Preparing to unpack .../31-python3-markdown-it_2.1.0-5_all.deb ...
    control: Unpacking python3-markdown-it (2.1.0-5) ...
    control: Selecting previously unselected package python3-rich.
    control: Preparing to unpack .../32-python3-rich_13.3.1-1_all.deb ...
    control: Unpacking python3-rich (13.3.1-1) ...
    control: Selecting previously unselected package python3-rfc3986.
    control: Preparing to unpack .../33-python3-rfc3986_1.5.0-2_all.deb ...
    control: Unpacking python3-rfc3986 (1.5.0-2) ...
    control: Selecting previously unselected package python3-httpx.
    control: Preparing to unpack .../34-python3-httpx_0.23.3-1_all.deb ...
    control: Unpacking python3-httpx (0.23.3-1) ...
    control: Selecting previously unselected package python3-jmespath.
    control: Preparing to unpack .../35-python3-jmespath_1.0.1-1_all.deb ...
    control: Unpacking python3-jmespath (1.0.1-1) ...
    control: Selecting previously unselected package python3-kerberos.
    control: Preparing to unpack .../36-python3-kerberos_1.1.14-3.1+b7_amd64.deb ...
    control: Unpacking python3-kerberos (1.1.14-3.1+b7) ...
    control: Selecting previously unselected package python3-lockfile.
    control: Preparing to unpack .../37-python3-lockfile_1%3a0.12.2-2.2_all.deb ...
    control: Unpacking python3-lockfile (1:0.12.2-2.2) ...
    control: Selecting previously unselected package python3-simplejson.
    control: Preparing to unpack .../38-python3-simplejson_3.18.3-1_amd64.deb ...
    control: Unpacking python3-simplejson (3.18.3-1) ...
    control: Selecting previously unselected package python3-libcloud.
    control: Preparing to unpack .../39-python3-libcloud_3.4.1-5_all.deb ...
    control: Unpacking python3-libcloud (3.4.1-5) ...
    control: Selecting previously unselected package python3-ntlm-auth.
    control: Preparing to unpack .../40-python3-ntlm-auth_1.4.0-2_all.deb ...
    control: Unpacking python3-ntlm-auth (1.4.0-2) ...
    control: Selecting previously unselected package python3-passlib.
    control: Preparing to unpack .../41-python3-passlib_1.7.4-3_all.deb ...
    control: Unpacking python3-passlib (1.7.4-3) ...
    control: Selecting previously unselected package python3-pathspec.
    control: Preparing to unpack .../42-python3-pathspec_0.11.0-1_all.deb ...
    control: Unpacking python3-pathspec (0.11.0-1) ...
    control: Selecting previously unselected package python3-requests-kerberos.
    control: Preparing to unpack .../43-python3-requests-kerberos_0.12.0-2_all.deb ...
    control: Unpacking python3-requests-kerberos (0.12.0-2) ...
    control: Selecting previously unselected package python3-requests-ntlm.
    control: Preparing to unpack .../44-python3-requests-ntlm_1.1.0-3_all.deb ...
    control: Unpacking python3-requests-ntlm (1.1.0-3) ...
    control: Selecting previously unselected package python3-requests-toolbelt.
    control: Preparing to unpack .../45-python3-requests-toolbelt_0.10.1-1_all.deb ...
    control: Unpacking python3-requests-toolbelt (0.10.1-1) ...
    control: Selecting previously unselected package python3-selinux.
    control: Preparing to unpack .../46-python3-selinux_3.4-1+b6_amd64.deb ...
    control: Unpacking python3-selinux (3.4-1+b6) ...
    control: Selecting previously unselected package python3-xmltodict.
    control: Preparing to unpack .../47-python3-xmltodict_0.13.0-1_all.deb ...
    control: Unpacking python3-xmltodict (0.13.0-1) ...
    control: Selecting previously unselected package python3-winrm.
    control: Preparing to unpack .../48-python3-winrm_0.3.0-4+deb12u1_all.deb ...
    control: Unpacking python3-winrm (0.3.0-4+deb12u1) ...
    control: Selecting previously unselected package sshpass.
    control: Preparing to unpack .../49-sshpass_1.09-1+b1_amd64.deb ...
    control: Unpacking sshpass (1.09-1+b1) ...
    control: Selecting previously unselected package yamllint.
    control: Preparing to unpack .../50-yamllint_1.29.0-1_all.deb ...
    control: Unpacking yamllint (1.29.0-1) ...
    control: Setting up python3-sniffio (1.2.0-1) ...
    control: Setting up python3-lockfile (1:0.12.2-2.2) ...
    control: Setting up python3-requests-toolbelt (0.10.1-1) ...
    control: Setting up python3-passlib (1.7.4-3) ...
    control: Setting up python3-anyio (3.6.2-1) ...
    control: Setting up python3-hyperframe (6.0.0-1) ...
    control: Setting up python3-hpack (4.0.0-2) ...
    control: Setting up python3-colorama (0.4.6-2) ...
    control: Setting up libyaml-0-2:amd64 (0.2.5-1) ...
    control: Setting up python3-ntlm-auth (1.4.0-2) ...
    control: Setting up python3-resolvelib (0.9.0-2) ...
    control: Setting up python3-kerberos (1.1.14-3.1+b7) ...
    control: Setting up python3-yaml (6.0-3+b2) ...
    control: Setting up python3-click (8.1.3-2) ...
    control: Setting up python3-markupsafe (2.1.2-1+b1) ...
    control: Setting up sshpass (1.09-1+b1) ...
    control: Setting up python3-tz (2022.7.1-4) ...
    control: Setting up python-babel-localedata (2.10.3-1) ...
    control: Setting up python3-simplejson (3.18.3-1) ...
    control: Setting up python3-xmltodict (0.13.0-1) ...
    control: Setting up python3-jinja2 (3.1.2-1+deb12u2) ...
    control: Setting up python3-pygments (2.14.0+dfsg-1) ...
    control: Setting up python3-packaging (23.0-1) ...
    control: Setting up python3-rfc3986 (1.5.0-2) ...
    control: Setting up python3-jmespath (1.0.1-1) ...
    control: Setting up python3-mdurl (0.1.2-1) ...
    control: Setting up python3-h11 (0.14.0-1) ...
    control: Setting up direnv (2.32.1-2+b4) ...
    control: Setting up python3-markdown-it (2.1.0-5) ...
    control: Setting up ieee-data (20220827.1) ...
    control: Setting up python3-dnspython (2.3.0-1) ...
    control: Setting up python3-selinux (3.4-1+b6) ...
    control: Setting up python3-h2 (4.1.0-4) ...
    control: Setting up python3-argcomplete (2.0.0-1) ...
    control: Setting up python3-pathspec (0.11.0-1) ...
    control: Setting up python3-lib2to3 (3.11.2-3) ...
    control: Setting up python3-cffi-backend:amd64 (1.15.1-5+b1) ...
    control: Setting up python3-distutils (3.11.2-3) ...
    control: Setting up python3-httpcore (0.16.3-1) ...
    control: Setting up python3-babel (2.10.3-1) ...
    control: update-alternatives: using /usr/bin/pybabel-python3 to provide /usr/bin/pybabel (pybabel) in auto mode
    control: Setting up python3-rich (13.3.1-1) ...
    control: Setting up yamllint (1.29.0-1) ...
    control: Setting up python3-httpx (0.23.3-1) ...
    control: Setting up python3-cryptography (38.0.4-3+deb12u1) ...
    control: Setting up python3-requests-kerberos (0.12.0-2) ...
    control: Setting up python3-netaddr (0.8.0-2) ...
    control: Setting up python3-requests-ntlm (1.1.0-3) ...
    control: Setting up ansible-core (2.14.18-0+deb12u2) ...
    control: Setting up python3-libcloud (3.4.1-5) ...
    control: Setting up python3-winrm (0.3.0-4+deb12u1) ...
    control: Setting up ansible (7.7.0+dfsg-3+deb12u1) ...
    control: Processing triggers for man-db (2.11.2-2) ...
    control: Processing triggers for libc-bin (2.36-9+deb12u3) ...
    control: Generating public/private rsa key pair.
    control: Enter file in which to save the key (/home/vagrant/.ssh/id_rsa): Your identification has been saved in /home/vagrant/.ssh/id_rsa
    control: Your public key has been saved in /home/vagrant/.ssh/id_rsa.pub
    control: The key fingerprint is:
    control: SHA256:It2q4xJ57cvNK7kPGuRybuFEWNVFEubTsCMQ1SSanB8 vagrant@control
    control: The key's randomart image is:
    control: +---[RSA 4096]----+
    control: |    o+++*+o      |
    control: |   ..= +o=       |
    control: |   o= E = .      |
    control: |  . .o + o       |
    control: |   oo.+ S        |
    control: |  oo+..o         |
    control: |  .=+oo.         |
    control: |  .++=++         |
    control: |   +=.+==.       |
    control: +----[SHA256]-----+
    control: Enter passphrase (empty for no passphrase): Enter same passphrase again: # target01:22 SSH-2.0-OpenSSH_9.2p1 Debian-2+deb12u2
    control: # target01.sandbox.lan:22 SSH-2.0-OpenSSH_9.2p1 Debian-2+deb12u2
    control: /usr/bin/ssh-copy-id: INFO: Source of key(s) to be installed: "/home/vagrant/.ssh/id_rsa.pub"
    control: /usr/bin/ssh-copy-id: INFO: attempting to log in with the new key(s), to filter out any that are already installed
    control: /usr/bin/ssh-copy-id: INFO: 1 key(s) remain to be installed -- if you are prompted now it is to install the new keys
    control: 
    control: Number of key(s) added: 1
    control: 
    control: Now try logging into the machine, with:   "ssh 'vagrant@target01'"
    control: and check to make sure that only the key(s) you wanted were added.
    control: 
    control: # target02:22 SSH-2.0-OpenSSH_9.2p1 Debian-2+deb12u2
    control: # target02.sandbox.lan:22 SSH-2.0-OpenSSH_9.2p1 Debian-2+deb12u2
    control: /usr/bin/ssh-copy-id: INFO: Source of key(s) to be installed: "/home/vagrant/.ssh/id_rsa.pub"
    control: /usr/bin/ssh-copy-id: INFO: attempting to log in with the new key(s), to filter out any that are already installed
    control: /usr/bin/ssh-copy-id: INFO: 1 key(s) remain to be installed -- if you are prompted now it is to install the new keys
    control: 
    control: Number of key(s) added: 1
    control: 
    control: Now try logging into the machine, with:   "ssh 'vagrant@target02'"
    control: and check to make sure that only the key(s) you wanted were added.
    control: 
    control: # target03:22 SSH-2.0-OpenSSH_9.2p1 Debian-2+deb12u2
    control: # target03.sandbox.lan:22 SSH-2.0-OpenSSH_9.2p1 Debian-2+deb12u2
    control: /usr/bin/ssh-copy-id: INFO: Source of key(s) to be installed: "/home/vagrant/.ssh/id_rsa.pub"
    control: /usr/bin/ssh-copy-id: INFO: attempting to log in with the new key(s), to filter out any that are already installed
    control: /usr/bin/ssh-copy-id: INFO: 1 key(s) remain to be installed -- if you are prompted now it is to install the new keys
    control: 
    control: Number of key(s) added: 1
    control: 
    control: Now try logging into the machine, with:   "ssh 'vagrant@target03'"
    control: and check to make sure that only the key(s) you wanted were added.
    control: 
    control: mkdir: created directory '/home/vagrant/ansible'
    control: mkdir: created directory '/home/vagrant/ansible/projets'
    control: mkdir: created directory '/home/vagrant/ansible/projets/ema'
    control: mkdir: created directory '/home/vagrant/ansible/projets/ema/playbooks'
    control: mkdir: created directory '/home/vagrant/logs'
    control: '/vagrant/ansible.cfg' -> '/home/vagrant/ansible/projets/ema/ansible.cfg'
    control: '/vagrant/inventory' -> '/home/vagrant/ansible/projets/ema/inventory'
[ema@testlab:atelier-09] $ 
[ema@testlab:atelier-09] $ vagrant ssh control
vagrant@control:~$ cd ansible/projets/ema/
direnv: loading ~/ansible/projets/ema/.envrc
direnv: export +ANSIBLE_CONFIG
vagrant@control:~/ansible/projets/ema$ cat inventory 
[debian]
target01
target02
target03

[debian:vars]
ansible_python_interpreter=/usr/bin/python3
ansible_user=vagrant
ansible_become=yes
vagrant@control:~/ansible/projets/ema$ ansible debian -m ping
target03 | SUCCESS => {
    "changed": false,
    "ping": "pong"
}
target01 | SUCCESS => {
    "changed": false,
    "ping": "pong"
}
target02 | SUCCESS => {
    "changed": false,
    "ping": "pong"
}
vagrant@control:~/ansible/projets/ema$ ls
ansible.cfg  inventory  playbooks
vagrant@control:~/ansible/projets/ema$ nano playbooks/apache-01.yml
vagrant@control:~/ansible/projets/ema$ yamllint apache-01.yml^C
vagrant@control:~/ansible/projets/ema$ cd playbooks/
vagrant@control:~/ansible/projets/ema/playbooks$ yamllint apache-01.yml
vagrant@control:~/ansible/projets/ema/playbooks$ ansible-playbook apache-01.yml 

PLAY [debian] ********************************************************************************************************

TASK [Gathering Facts] ***********************************************************************************************
ok: [target02]
ok: [target01]
ok: [target03]

TASK [Update package information] ************************************************************************************
changed: [target02]
changed: [target01]
changed: [target03]

PLAY RECAP ***********************************************************************************************************
target01                   : ok=2    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
target02                   : ok=2    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
target03                   : ok=2    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

vagrant@control:~/ansible/projets/ema/playbooks$ nano apache-01.yml 
vagrant@control:~/ansible/projets/ema/playbooks$ ansible-playbook apache-01.yml 

PLAY [debian] ********************************************************************************************************

TASK [Gathering Facts] ***********************************************************************************************
ok: [target01]
ok: [target03]
ok: [target02]

TASK [Update package information] ************************************************************************************
ok: [target03]
ok: [target02]
ok: [target01]

PLAY RECAP ***********************************************************************************************************
target01                   : ok=2    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
target02                   : ok=2    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
target03                   : ok=2    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

vagrant@control:~/ansible/projets/ema/playbooks$ nano apache-01.yml 
vagrant@control:~/ansible/projets/ema/playbooks$ nano apache-01.yml 
vagrant@control:~/ansible/projets/ema/playbooks$ cat apache-01.yml 
---  # apache-01.yml

- hosts: debian

  tasks:

    - name: Update package information
      apt:
        update_cache: true
        cache_valid_time: 3600

    - name: Install Apache
      apt:
        name: apache2

    - name: Start & enable Apache
      service:
        name: apache2
        state: started
        enabled: true

    - name: Install custom web page
      copy:
        dest: /var/www/html/index.html
        mode: 0644
        content: |
          <!doctype html>
          <html>
            <head>
              <meta charset="utf-8">
              <title>Test</title>
            </head>
            <body>
              <h1>My first Ansible-managed website</h1>
            </body>
          </html>

---
vagrant@control:~/ansible/projets/ema/playbooks$ yamllint apache-01.yml
vagrant@control:~/ansible/projets/ema/playbooks$ ansible-playbook apache-01.yml
ERROR! We were unable to read either as JSON nor YAML, these are the errors we got from each:
JSON: Expecting value: line 1 column 1 (char 0)

Syntax Error while loading YAML.
  but found another document

The error appears to be in '/home/vagrant/ansible/projets/ema/playbooks/apache-01.yml': line 38, column 1, but may
be elsewhere in the file depending on the exact syntax problem.

The offending line appears to be:


---
^ here
vagrant@control:~/ansible/projets/ema/playbooks$ nano apache-01.yml 
vagrant@control:~/ansible/projets/ema/playbooks$ ansible-playbook apache-01.yml

PLAY [debian] ********************************************************************************************************

TASK [Gathering Facts] ***********************************************************************************************
ok: [target02]
ok: [target01]
ok: [target03]

TASK [Update package information] ************************************************************************************
ok: [target03]
ok: [target01]
ok: [target02]

TASK [Install Apache] ************************************************************************************************
changed: [target02]
changed: [target03]
changed: [target01]

TASK [Start & enable Apache] *****************************************************************************************
ok: [target02]
ok: [target03]
ok: [target01]

TASK [Install custom web page] ***************************************************************************************
changed: [target01]
changed: [target02]
changed: [target03]

PLAY RECAP ***********************************************************************************************************
target01                   : ok=5    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
target02                   : ok=5    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
target03                   : ok=5    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

vagrant@control:~/ansible/projets/ema/playbooks$ nano apache-01.yml 
vagrant@control:~/ansible/projets/ema/playbooks$ ansible-playbook apache-01.yml --start-at-task="*page*"

PLAY [debian] ********************************************************************************************************

TASK [Gathering Facts] ***********************************************************************************************
ok: [target02]
ok: [target03]
ok: [target01]

TASK [Install custom web page] ***************************************************************************************
changed: [target02]
changed: [target03]
changed: [target01]

PLAY RECAP ***********************************************************************************************************
target01                   : ok=2    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
target02                   : ok=2    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
target03                   : ok=2    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

vagrant@control:~/ansible/projets/ema/playbooks$ exit
logout
Connection to 127.0.0.1 closed.
[ema@testlab:atelier-09] $ vagrant destroy -f
==> control: Forcing shutdown of VM...
==> control: Destroying VM and associated drives...
==> target03: Forcing shutdown of VM...
==> target03: Destroying VM and associated drives...
==> target02: Forcing shutdown of VM...
==> target02: Destroying VM and associated drives...
==> target01: Forcing shutdown of VM...
==> target01: Destroying VM and associated drives...
[ema@testlab:atelier-09] $ 
